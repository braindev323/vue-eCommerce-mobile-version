<template>
  <div>
    <Header />
    <Breadcrumbs :title="getDetail.productName" />
    <section class="section-b-space">
      <div class="collection-wrapper">
        <div class="container">
          <div class="row">
            <div class="col-lg-3">
            <!-- <productSidebar /> -->
            </div>
            <div class="col-lg-9 col-sm-12 col-xs-12 productdetail">
              <div class="container-fluid">
                <div class="row">
                  <div class="col-lg-6">
                    <div v-swiper:mySwiper="swiperOption" ref="mySwiper">
                      <div class="swiper-wrapper">
                        <div
                          class="swiper-slide"
                          v-for="(product,index) in [1,2,3]"
                          :key="index"
                        >
                          <img
                              :src='require("@/assets/images/ajax-loader.gif")'
                              class="img-fluid bg-img w-100"
                            />
                          <img
                            :src="getDetail.productPictureURL||require('@/assets/images/pro/1.jpg')"
                            :id="index"
                            class="img-fluid bg-img r-img"
                            :alt="`product${index}`"
                          />
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-12 slider-nav-images">
                        <div v-swiper:mySwiper1="swiperOption1">
                          <div class="swiper-wrapper">
                            <div
                              class="swiper-slide"
                              v-for="(product,index) in [1,2,3]"
                              :key="index"
                            >
                               <img
                                    :src='require("@/assets/images/ajax-loader.gif")'
                                    class="img-fluid bg-img w-100"
                                  />
                                <img
                                  :src="getDetail.productPictureURL||require('@/assets/images/pro/1.jpg')"
                                  :id="index"
                                  class="img-fluid bg-img r-img"
                                  :alt="`product${index}`"
                                />
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col-lg-6 rtl-text">
                    <div class="product-right">
                      <h2>{{ getDetail.productName }}</h2>
                      <h4 v-if="getDetail.sale">
                        <del>{{ getDetail.priceInMinorUnits * currency.curr | currency(currency.symbol) }}</del>
                        <span>{{ getDetail.discount }}% off</span>
                      </h4>
                      <h3 v-if="getDetail.sale">{{ discountedPrice(getDetail) * currency.curr | currency(currency.symbol) }}</h3>
                      <h3 v-else>{{ getDetail.priceInMinorUnits * currency.curr | currency(currency.symbol) }}</h3>

                      <div class="product-description border-product">
<!--                        <h5 class="avalibility" v-if="counter <= getDetail.quantity">-->
<!--                          <span>In Stock</span>-->
<!--                        </h5>-->
<!--                        <h5 class="avalibility" v-if="counter > getDetail.quantity">-->
<!--                          <span>Out of Stock</span>-->
<!--                        </h5>-->
                        <h6 class="product-title">quantity</h6>
                        <div class="qty-box">
                          <div class="input-group">
                            <span class="input-group-prepend">
                              <button
                                type="button"
                                class="btn quantity-left-minus"
                                data-type="minus"
                                data-field
                                v-on:click="decrement()"
                              >
                                <i class="ti-angle-left"></i>
                              </button>
                            </span>
                            <input
                              type="text"
                              name="quantity"
                              class="form-control input-number"
                              v-model="counter"
                            />
                            <span class="input-group-prepend">
                              <button
                                type="button"
                                class="btn quantity-right-plus"
                                data-type="plus"
                                data-field
                                v-on:click="increment()"
                              >
                                <i class="ti-angle-right"></i>
                              </button>
                            </span>
                          </div>
                        </div>
                      </div>
                      <div class="product-buttons">
                        <router-link :to="{ path: '/page/account/cart'}">
                          <button
                            class="btn btn-solid"
                            title="Add to cart"
                            @click="addToCart(getDetail, counter)"
                          >Add To Cart</button>
                        </router-link>
                      </div>
                      <div class="border-product">
                        <h6 class="product-title">product details</h6>
                        <p>{{getDetail.full_description&&getDetail.full_description}}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <section class="tab-product m-0">
                <div class="row">
                  <div class="col-sm-12 col-lg-12">
                    <b-tabs card>
                      <b-tab title="Description" active>
                        <b-card-text>{{getDetail.full_description}}</b-card-text>
                      </b-tab>
                      <b-tab title="Details">
                        <b-card-text>
                          {{getDetail.productDescription}}
                          <div class="single-product-tables">

<!--                            <table>-->
<!--                              <tbody>-->
<!--                                <tr>-->
<!--                                  <td>Febric</td>-->
<!--                                  <td>Chiffon</td>-->
<!--                                </tr>-->
<!--                                <tr>-->
<!--                                  <td>Color</td>-->
<!--                                  <td>Red</td>-->
<!--                                </tr>-->
<!--                                <tr>-->
<!--                                  <td>Material</td>-->
<!--                                  <td>Crepe printed</td>-->
<!--                                </tr>-->
<!--                              </tbody>-->
<!--                            </table>-->

<!--                            <table>-->
<!--                              <tbody>-->
<!--                                <tr>-->
<!--                                  <td>Length</td>-->
<!--                                  <td>50 Inches</td>-->
<!--                                </tr>-->
<!--                                <tr>-->
<!--                                  <td>Size</td>-->
<!--                                  <td>S, M, L .XXL</td>-->
<!--                                </tr>-->
<!--                              </tbody>-->
<!--                            </table>-->
                          </div>
                        </b-card-text>
                      </b-tab>

                      <b-tab title="Video">
<!--                        <b-card-text>-->
<!--                          <div class="mt-3 text-center">-->
<!--                            <iframe-->
<!--                              width="560"-->
<!--                              height="315"-->
<!--                              src="https://www.youtube.com/embed/BUWzX78Ye_8"-->
<!--                              allow="autoplay; encrypted-media"-->
<!--                              allowfullscreen-->
<!--                            ></iframe>-->
<!--                          </div>-->
<!--                        </b-card-text>-->
                      </b-tab>

<!--                      <b-tab title="Write Review">-->
<!--                        <b-card-text>-->
<!--                          <form class="theme-form">-->
<!--                            <div class="form-row">-->
<!--                              <div class="col-md-12">-->
<!--                                <div class="media">-->
<!--                                  <label>Rating</label>-->
<!--                                  <div class="media-body ml-3">-->
<!--                                    <div class="rating three-star">-->
<!--                                      <i class="fa fa-star"></i>-->
<!--                                      <i class="fa fa-star"></i>-->
<!--                                      <i class="fa fa-star"></i>-->
<!--                                      <i class="fa fa-star"></i>-->
<!--                                      <i class="fa fa-star"></i>-->
<!--                                    </div>-->
<!--                                  </div>-->
<!--                                </div>-->
<!--                              </div>-->
<!--                              <div class="col-md-6">-->
<!--                                <label for="name">Name</label>-->
<!--                                <input-->
<!--                                  type="text"-->
<!--                                  class="form-control"-->
<!--                                  id="name"-->
<!--                                  placeholder="Enter Your name"-->
<!--                                  required-->
<!--                                />-->
<!--                              </div>-->
<!--                              <div class="col-md-6">-->
<!--                                <label for="email">Email</label>-->
<!--                                <input-->
<!--                                  type="text"-->
<!--                                  class="form-control"-->
<!--                                  id="email"-->
<!--                                  placeholder="Email"-->
<!--                                  required-->
<!--                                />-->
<!--                              </div>-->
<!--                              <div class="col-md-12">-->
<!--                                <label for="review">Review Title</label>-->
<!--                                <input-->
<!--                                  type="text"-->
<!--                                  class="form-control"-->
<!--                                  id="review"-->
<!--                                  placeholder="Enter your Review Subjects"-->
<!--                                  required-->
<!--                                />-->
<!--                              </div>-->
<!--                              <div class="col-md-12">-->
<!--                                <label for="review">Review Title</label>-->
<!--                                <textarea-->
<!--                                  class="form-control"-->
<!--                                  placeholder="Wrire Your Testimonial Here"-->
<!--                                  id="exampleFormControlTextarea1"-->
<!--                                  rows="6"-->
<!--                                ></textarea>-->
<!--                              </div>-->
<!--                              <div class="col-md-12">-->
<!--                                <button class="btn btn-solid" type="submit">Submit YOur Review</button>-->
<!--                              </div>-->
<!--                            </div>-->
<!--                          </form>-->
<!--                        </b-card-text>-->
<!--                      </b-tab>-->

                    </b-tabs>
                  </div>
                </div>
              </section>
            </div>
          </div>
        </div>
      </div>

      <b-modal id="modal-1" size="md" centered hide-footer>
        <template v-slot:modal-title>{{getDetail.productName}}</template>
        <img src="@/assets/images/size-chart.jpg" alt="size-chart" class="img-fluid" />
      </b-modal>

    </section>
    <Footer />
  </div>
</template>
<script>
import { mapState, mapGetters } from 'vuex'
import Header from '@/components/header'
import Footer from '@/components/footer'
import Breadcrumbs from '@/components/widgets/breadcrumbs'
// import Timer from '@/components/widgets/timer'

export default {
  components: {
    Header,
    Footer,
    Breadcrumbs,
    // Timer,
    // productSidebar
  },
  data() {
    return {
      counter: 1,
      activeColor: '',
      selectedSize: '',
      size: [],
      swiperOption: {
        slidesPerView: 1,
        spaceBetween: 20,
        freeMode: true
      },
      swiperOption1: {
        slidesPerView: 3,
        spaceBetween: 30,
        freeMode: true,
        centeredSlides: false
      }
    }
  },
  computed: {
    ...mapState({
      currency: state => state.products.currency
    }),
    ...mapGetters({
      curr: 'products/changeCurrency'
    }),
    getDetail: function () {
      return this.$store.getters['products/getProductById'](
        this.$route.params.id
      )
    },
    swiper() {
      return this.$refs.mySwiper.swiper
    }
  },
  mounted() {
    // For displaying default color and size on pageload

    // this.uniqColor = this.getDetail.variants[0].color
    // this.sizeVariant(this.getDetail.variants[0].image_id)
    // Active default color
    this.activeColor = this.uniqColor
    // this.changeSizeVariant(this.getDetail.variants[0].size)
  },
  methods: {
    priceCurrency: function () {
      this.$store.dispatch('products/changeCurrency')
    },
    addToWishlist: function (product) {
      this.$store.dispatch('products/addToWishlist', product)
    },
    discountedPrice(product) {
      const price = product.price - (product.price * product.discount / 100)
      return price
    },
    // Display Unique Color
    Color(variants) {
      const uniqColor = []
      for (let i = 0; i < Object.keys(variants).length; i++) {
        if (uniqColor.indexOf(variants[i].color) === -1) {
          uniqColor.push(variants[i].color)
        }
      }
      return uniqColor
    },
    // add to cart
    addToCart: function (product, qty) {
      this.$store.dispatch('cart/addToCart', {product,qty})
    },

    // Item Count
    increment() {
      if (this.counter < this.getDetail.quantity) this.counter++
    },
    decrement() {
      if (this.counter > 1) this.counter--
    },
    // Change size variant
    changeSizeVariant(variant) {
      this.selectedSize = variant
    },
    slideTo(id) {
      this.swiper.slideTo(id, 1000, false)
    },
    sizeVariant(id, slideId, color) {
      this.swiper.slideTo(slideId, 1000, false)
      this.size = []
      this.activeColor = color
      this.getDetail.variants.filter((item) => {
        if (id === item.image_id) {
          this.size.push(item.size)
        }
      })
    }
  }
}
</script>
